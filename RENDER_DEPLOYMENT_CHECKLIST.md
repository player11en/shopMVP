# Render.com Deployment Checklist

## âœ… Code is Ready for Deployment

All code uses environment variables with proper fallbacks. The following will work on Render.com:

### Backend (medusa-backend service)

**Required Environment Variables (set in Render dashboard):**
- âœ… `DATABASE_URL` - PostgreSQL connection string
- âœ… `STORE_CORS` - Should include your storefront URL (e.g., `https://storefront-XXXX.onrender.com,http://localhost:3000`)
- âœ… `ADMIN_CORS` - Should include admin URL (e.g., `https://medusa-backend-XXXX.onrender.com/app,http://localhost:7001`)
- âœ… `AUTH_CORS` - Should match STORE_CORS
- âœ… `JWT_SECRET` - Auto-generated by Render (or set manually)
- âœ… `COOKIE_SECRET` - Auto-generated by Render (or set manually)
- âœ… `STRIPE_API_KEY` - Your Stripe API key
- âœ… `STRIPE_WEBHOOK_SECRET` - Your Stripe webhook secret
- âœ… `PAYPAL_CLIENT_ID` - Your PayPal client ID
- âœ… `PAYPAL_CLIENT_SECRET` - Your PayPal client secret
- âœ… `PAYPAL_ENVIRONMENT` - `sandbox` or `live`
- âœ… `MEDUSA_ADMIN_EMAIL` - Admin email for auto-creation
- âœ… `MEDUSA_ADMIN_PASSWORD` - Admin password for auto-creation
- âœ… `PORT` - Set to `9000` (already in render.yaml)

**Code checks:**
- âœ… `medusa-config.ts` reads all env vars correctly
- âœ… No hardcoded URLs in backend code
- âœ… CORS configuration uses env vars
- âœ… Admin user auto-creation script uses env vars

### Frontend (storefront service)

**Required Environment Variables (set in Render dashboard):**
- âœ… `NEXT_PUBLIC_MEDUSA_BACKEND_URL` - Your backend URL (e.g., `https://medusa-backend-XXXX.onrender.com`)
- âœ… `NEXT_PUBLIC_MEDUSA_API_KEY` - Publishable API key from Medusa admin

**Code checks:**
- âœ… `lib/medusa.ts` uses `process.env.NEXT_PUBLIC_MEDUSA_BACKEND_URL` with fallback
- âœ… `lib/medusa.ts` uses `process.env.NEXT_PUBLIC_MEDUSA_API_KEY` with fallback
- âœ… `app/api/medusa-proxy/route.ts` uses env vars correctly
- âœ… All API calls go through proxy or use env vars
- âœ… No hardcoded localhost URLs in production code (only in comments/help text)

### Important Notes:

1. **CORS URLs**: Make sure your `STORE_CORS` and `AUTH_CORS` include your actual Render storefront URL. Update them in Render dashboard after deployment.

2. **Backend URL**: The `NEXT_PUBLIC_MEDUSA_BACKEND_URL` should be set to your actual backend URL (e.g., `https://medusa-backend-XXXX.onrender.com`). The `fromService` in render.yaml might work, but if not, set it manually.

3. **API Key**: After backend deploys, go to `https://your-backend-url.onrender.com/app`, create an API key, and set it as `NEXT_PUBLIC_MEDUSA_API_KEY` in the storefront service.

4. **Database**: Make sure your PostgreSQL database is running and accessible from the backend service.

5. **Payment Providers**: After deployment, go to Admin â†’ Settings â†’ Regions â†’ Your Region â†’ Payment Providers and enable the providers you want to use.

## ðŸš€ Deployment Steps:

1. Push code to GitHub
2. Render will auto-deploy from `render.yaml`
3. Set all environment variables in Render dashboard (the ones marked `sync: false`)
4. Wait for both services to build and start
5. Get API key from backend admin panel
6. Set `NEXT_PUBLIC_MEDUSA_API_KEY` in storefront service
7. Update CORS URLs in backend service to match your actual URLs
8. Test the storefront!

## âœ… Everything Should Work!

All code is environment-aware and will work on Render.com as long as you set the environment variables correctly in the Render dashboard.

